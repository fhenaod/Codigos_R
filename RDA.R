library(vegan)

sp<-read.delim(file.choose(), header=T)
amb<-read.delim(file.choose(), header=T)
spp<-decostand(sp, "hellinger")
sp_amb<-rda(spp~fragmentacion+N+inundacion+pH+CIC+A+L+Min_preci+T_min, data=amb)
plot(sp_amb, xlim=c(-1,1.2), ylim=c(-0.8, 0.9))
plot(sp_amb)
parcelas<-scores(sp_amb, choices=c(1,2,3,4,5,6), display=c("sites"))
vectores<-scores(sp_amb, choices=c(1,2,3,4,5,6), display=c("bp"))
especies<-scores(sp_amb, choices=c(1,2,3,4,5,6), display=c("sp"))
points(sp_amb, display="sp", cex=1, pch=16,col="white")
points(sp_amb, display="sp", cex=0.3, pch=3,col="grey")
points(sp_amb, display="sites", cex=1, pch=16, col="white")
text(sp_amb, display="bp", col="white", cex= 1)
text(sp_amb, display="bp", col="grey26")
points(sp_amb, display="bp", cex=1, pch=16, col="grey")
points(-0.3219807, 0.109371816,col="blue", pch= 0)
points(-0.3891880, 0.002637192,col="blue", pch= 0)
points(-0.1751150, 0.802681404,col="blue", pch= 2)
points(-0.2443324, 0.791384319,col="blue", pch= 2)
points(-0.3198019, -0.635982273,col="black", pch= 0)
points(-0.2976847, -0.625594634,col="black", pch= 0)
points(-0.2776941, -0.522524032,col="black", pch= 0)
points(-0.3461705, -0.613885573,col="black", pch= 0)
points(0.5783350, -0.003579262,col="black", pch= 8)
points(-0.2250722, -0.180185296,col="black", pch= 7)
points(-0.2262560, -0.210438154,col="black", pch= 7)
points(-0.1916426, -0.291638336,col="black", pch= 7)
points(0.5006024, 0.082009306,col="black", pch= 8)
points(0.8677717, 0.016559115,col="black", pch= 2)
points(0.8836529, -0.036101736,col="black", pch= 2)
points(0.8397503, -0.095225037,col="black", pch= 2)
points(-0.3191754, 0.700848227,col="red", pch= 7)
points(-0.3359989, 0.709662952,col="red", pch= 7)
legend(0.6,0.8, c("Caparu","Tomo Grande", "San Juan", "San Martin"), pch=c(0,2,7,8), cex=0.99, pt.cex=0.99)
legend(0.6,0.4, c("Igapo", "Tierra Firme", "Varzea"), fill=c("blue", "black", "red"), cex=0.7)
